{"is_source_file": true, "format": "Python", "description": "Defines an in-memory database class for managing users, ride offers, ride requests, notifications, and seat allocations in a carpool management system. Includes methods for CRUD operations and seat management.", "external_files": ["src/models/user", "src/models/ride", "src/models/common"], "external_methods": [], "published": ["db"], "classes": [{"name": "InMemoryDB", "description": "A simple self-contained in-memory database for development and testing, managing users, ride offers/requests, notifications, and seat allocations."}], "methods": [{"name": "None reset(self)", "description": "Resets the database to an empty state by reinitializing.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "User create_user(self, payload: UserCreate, password_hash: str)", "description": "Creates and stores a new user with a generated UUID and returns the User object.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "Optional[User] update_user(self, user_id: str, payload: UserUpdate, new_password_hash: Optional[str])", "description": "Updates user details if the user exists; updates password if provided.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "Optional[Tuple[User,str]] get_user_by_email(self, email: str)", "description": "Retrieves a user and password hash by email.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "Optional[User] get_user(self, user_id: str)", "description": "Returns a user by their ID.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "List[User] list_users(self)", "description": "Returns a list of all users.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "bool delete_user(self, user_id: str)", "description": "Deletes a user by ID if they exist.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "RideOffer create_ride_offer(self, payload: RideOfferCreate)", "description": "Creates and stores a new ride offer with a unique ID.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "List[RideOffer] list_ride_offers(self)", "description": "Returns a list of all ride offers.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "Optional[RideOffer] get_ride_offer(self, offer_id: str)", "description": "Retrieves a ride offer by ID.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "RideOffer update_ride_offer(self, offer: RideOffer)", "description": "Updates and persists a ride offer.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "RideRequest create_ride_request(self, payload: RideRequestCreate)", "description": "Creates and stores a new ride request with a generated ID.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "List[RideRequest] list_ride_requests(self)", "description": "Returns all ride requests.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "Optional[RideRequest] get_ride_request(self, request_id: str)", "description": "Retrieves a ride request by ID.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "RideRequest update_ride_request(self, request: RideRequest)", "description": "Updates a ride request.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "Notification add_notification(self, notif: Notification)", "description": "Adds a notification to the store.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "List[Notification] list_notifications_for_user(self, user_id: str)", "description": "Lists all notifications for a specified user.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "int get_allocated_seats(self, offer_id: str)", "description": "Returns the number of seats currently allocated for an offer.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "None allocate_seats(self, offer_id: str, seats: int)", "description": "Increases seat allocation for a specific offer.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "None release_seats(self, offer_id: str, seats: int)", "description": "Decreases seat allocation for a specific offer.", "scope": "InMemoryDB", "scopeKind": "class"}, {"name": "None __init__(self)", "scope": "InMemoryDB", "scopeKind": "class", "description": "unavailable"}], "calls": ["uuid.uuid4", "self.__init__", "self.users", "self.passwords", "self.ride_offers", "self.ride_requests", "self.notifications", "self.offer_allocations", "user.meta.touch", "u.model_dump", "req.model_dump"], "search-terms": ["MemoryDB", "InMemoryDB", "seat_allocations", "ride_offers", "ride_requests", "notifications", "reset"], "state": 2, "file_id": 9, "knowledge_revision": 64, "git_revision": "6dea69da98dddace0a48b7a3bdd654c526418a60", "revision_history": [{"20": ""}, {"64": "6dea69da98dddace0a48b7a3bdd654c526418a60"}], "ctags": [{"_type": "tag", "name": "InMemoryDB", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^class InMemoryDB:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "add_notification", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def add_notification(self, notif: Notification) -> Notification:$/", "language": "Python", "typeref": "typename:Notification", "kind": "member", "signature": "(self, notif: Notification)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "allocate_seats", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def allocate_seats(self, offer_id: str, seats: int) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, offer_id: str, seats: int)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "create_ride_offer", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def create_ride_offer(self, payload: RideOfferCreate) -> RideOffer:$/", "language": "Python", "typeref": "typename:RideOffer", "kind": "member", "signature": "(self, payload: RideOfferCreate)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "create_ride_request", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def create_ride_request(self, payload: RideRequestCreate) -> RideRequest:$/", "language": "Python", "typeref": "typename:RideRequest", "kind": "member", "signature": "(self, payload: RideRequestCreate)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def create_user(self, payload: UserCreate, password_hash: str) -> User:$/", "language": "Python", "typeref": "typename:User", "kind": "member", "signature": "(self, payload: UserCreate, password_hash: str)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "db", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^db = InMemoryDB()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "delete_user", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def delete_user(self, user_id: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, user_id: str)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "get_allocated_seats", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def get_allocated_seats(self, offer_id: str) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "member", "signature": "(self, offer_id: str)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "get_ride_offer", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def get_ride_offer(self, offer_id: str) -> Optional[RideOffer]:$/", "language": "Python", "typeref": "typename:Optional[RideOffer]", "kind": "member", "signature": "(self, offer_id: str)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "get_ride_request", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def get_ride_request(self, request_id: str) -> Optional[RideRequest]:$/", "language": "Python", "typeref": "typename:Optional[RideRequest]", "kind": "member", "signature": "(self, request_id: str)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "get_user", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def get_user(self, user_id: str) -> Optional[User]:$/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "member", "signature": "(self, user_id: str)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "get_user_by_email", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def get_user_by_email(self, email: str) -> Optional[Tuple[User, str]]:$/", "language": "Python", "typeref": "typename:Optional[Tuple[User,str]]", "kind": "member", "signature": "(self, email: str)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "list_notifications_for_user", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def list_notifications_for_user(self, user_id: str) -> List[Notification]:$/", "language": "Python", "typeref": "typename:List[Notification]", "kind": "member", "signature": "(self, user_id: str)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "list_ride_offers", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def list_ride_offers(self) -> List[RideOffer]:$/", "language": "Python", "typeref": "typename:List[RideOffer]", "kind": "member", "signature": "(self)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "list_ride_requests", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def list_ride_requests(self) -> List[RideRequest]:$/", "language": "Python", "typeref": "typename:List[RideRequest]", "kind": "member", "signature": "(self)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "list_users", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def list_users(self) -> List[User]:$/", "language": "Python", "typeref": "typename:List[User]", "kind": "member", "signature": "(self)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "release_seats", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def release_seats(self, offer_id: str, seats: int) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, offer_id: str, seats: int)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "reset", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def reset(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "update_ride_offer", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def update_ride_offer(self, offer: RideOffer) -> RideOffer:$/", "language": "Python", "typeref": "typename:RideOffer", "kind": "member", "signature": "(self, offer: RideOffer)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "update_ride_request", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def update_ride_request(self, request: RideRequest) -> RideRequest:$/", "language": "Python", "typeref": "typename:RideRequest", "kind": "member", "signature": "(self, request: RideRequest)", "scope": "InMemoryDB", "scopeKind": "class"}, {"_type": "tag", "name": "update_user", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/db/memory.py", "pattern": "/^    def update_user(self, user_id: str, payload: UserUpdate, new_password_hash: Optional[str]) -/", "language": "Python", "typeref": "typename:Optional[User]", "kind": "member", "signature": "(self, user_id: str, payload: UserUpdate, new_password_hash: Optional[str])", "scope": "InMemoryDB", "scopeKind": "class"}], "hash": "ba5f07fda6da17005a2e71f838d0f73c", "format-version": 4, "code-base-name": "carpool_backend", "filename": "carpool_backend/src/db/memory.py", "fields": [{"name": "db = InMemoryDB()", "scope": "", "scopeKind": "", "description": "unavailable"}]}