{"is_source_file": true, "format": "Python", "description": "This file contains security-related functions for authentication, authorization, and token handling in a FastAPI backend, including password hashing, token creation and decoding, and user role verification.", "external_files": ["src.core.config", "src.db.memory", "src.models.enums", "src.models.user", "fastapi"], "external_methods": ["get_settings", "db.get_user", "UserPublic"], "published": ["hash_password", "verify_password", "create_access_token", "decode_access_token", "get_current_user_from_token", "require_auth", "require_role"], "classes": [], "methods": [{"name": "str _b64encode(data: bytes)", "description": "Encodes bytes to URL-safe base64 string without padding.", "scope": "", "scopeKind": ""}, {"name": "bytes _b64decode(data: str)", "description": "Decodes URL-safe base64 string to bytes, adding padding as needed.", "scope": "", "scopeKind": ""}, {"name": "str hash_password(password: str)", "description": "Hashes a password with a secret key using SHA-256.", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(password: str, hashed: str)", "description": "Verifies a plaintext password against a hashed version.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(sub: str, expires_minutes: Optional[int] = None)", "description": "Creates a JWT-like token with user info and expiration.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict] decode_access_token(token: str)", "description": "Decodes and verifies a JWT-like token, returning payload if valid.", "scope": "", "scopeKind": ""}, {"name": "Optional[UserPublic] get_current_user_from_token(token: Optional[str])", "description": "Retrieves UserPublic info based on the provided token.", "scope": "", "scopeKind": ""}, {"name": "UserPublic require_auth(token: Optional[str] = None)", "description": "Enforces authentication, raises HTTP 401 if not authenticated.", "scope": "", "scopeKind": ""}, {"name": "Callable[...,UserPublic] require_role(required: UserRole)", "description": "Returns a function that enforces a specific user role, raising HTTP 403 if check fails.", "scope": "", "scopeKind": ""}, {"name": "UserPublic _inner(token: Optional[str] = None)", "scope": "require_role", "scopeKind": "function", "description": "unavailable"}], "calls": ["get_settings()", "db.get_user(uid)", "hashlib.sha256()", "hmac.compare_digest()", "json.dumps()", "json.loads()", "datetime.utcnow()", "timedelta()", "hmac.new()", "base64.urlsafe_b64encode()", "base64.urlsafe_b64decode()"], "search-terms": ["security", "token", "JWT", "password hashing", "access control", "FastAPI security", "UserPublic"], "state": 2, "file_id": 11, "knowledge_revision": 62, "git_revision": "7d828af2b4121717e3d8fe624b130f3df0a48d88", "revision_history": [{"28": ""}, {"52": "6dea69da98dddace0a48b7a3bdd654c526418a60"}, {"62": "7d828af2b4121717e3d8fe624b130f3df0a48d88"}], "ctags": [{"_type": "tag", "name": "_b64decode", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def _b64decode(data: str) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "function", "signature": "(data: str)"}, {"_type": "tag", "name": "_b64encode", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def _b64encode(data: bytes) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: bytes)"}, {"_type": "tag", "name": "_inner", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^    def _inner(token: Optional[str] = None) -> UserPublic:$/", "file": true, "language": "Python", "typeref": "typename:UserPublic", "kind": "function", "signature": "(token: Optional[str] = None)", "scope": "require_role", "scopeKind": "function"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def create_access_token(sub: str, expires_minutes: Optional[int] = None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(sub: str, expires_minutes: Optional[int] = None)"}, {"_type": "tag", "name": "decode_access_token", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def decode_access_token(token: str) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "get_current_user_from_token", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def get_current_user_from_token(token: Optional[str]) -> Optional[UserPublic]:$/", "language": "Python", "typeref": "typename:Optional[UserPublic]", "kind": "function", "signature": "(token: Optional[str])"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "require_auth", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def require_auth(token: Optional[str] = None) -> UserPublic:$/", "language": "Python", "typeref": "typename:UserPublic", "kind": "function", "signature": "(token: Optional[str] = None)"}, {"_type": "tag", "name": "require_role", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def require_role(required: UserRole) -> Callable[..., UserPublic]:$/", "language": "Python", "typeref": "typename:Callable[...,UserPublic]", "kind": "function", "signature": "(required: UserRole)"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def verify_password(password: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(password: str, hashed: str)"}], "hash": "6e59b3c9b55d16460a63f8f576c375cb", "format-version": 4, "code-base-name": "carpool_backend", "filename": "carpool_backend/src/core/security.py"}