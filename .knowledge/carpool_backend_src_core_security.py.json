{"is_source_file": true, "format": "Python", "description": "This file contains security-related utilities and functions for password hashing, token creation and decoding, and user authentication, including role enforcement, within a FastAPI-based application.", "external_files": ["src/core/config.py", "src/db/memory.py", "src/models/enums.py", "src/models/user.py"], "external_methods": ["get_settings", "db.get_user"], "published": ["hash_password", "verify_password", "create_access_token", "decode_access_token", "get_current_user_from_token", "require_auth", "require_role"], "classes": [{"name": "UserPublic", "description": "Data model representing a public-facing user object, used for returning user info after authentication."}], "methods": [{"name": "str hash_password(password: str)", "description": "Hashes a password using SHA-256 with a secret key salt (not for production use).", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(password: str, hashed: str)", "description": "Verifies if a plaintext password matches a hashed password.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(sub: str, expires_minutes: Optional[int] = None)", "description": "Creates a signed JWT-like token containing subject, expiration, issuance time, and issuer.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict] decode_access_token(token: str)", "description": "Decodes and verifies a token, checking signature and expiration.", "scope": "", "scopeKind": ""}, {"name": "Optional[UserPublic] get_current_user_from_token(token: Optional[str])", "description": "Retrieves the current user object based on a valid token.", "scope": "", "scopeKind": ""}, {"name": "UserPublic require_auth(token: Optional[str] = None)", "description": "FastAPI dependency-like function that enforces authentication, raising HTTP 401 if invalid.", "scope": "", "scopeKind": ""}, {"name": "Callable[...,UserPublic] require_role(required: UserRole)", "description": "Returns a callable that enforces a user role, raising HTTP 403 if the role requirement is not met.", "scope": "", "scopeKind": ""}, {"name": "bytes _b64decode(data: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _b64encode(data: bytes)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UserPublic _inner(token: Optional[str] = None)", "scope": "require_role", "scopeKind": "function", "description": "unavailable"}], "calls": ["get_settings", "db.get_user", "hashlib.sha256", "hmac.compare_digest", "json.dumps", "base64.urlsafe_b64encode", "base64.urlsafe_b64decode", "datetime.utcnow", "timedelta", "hmac.new"], "search-terms": ["security", "token", "JWT", "password hashing", "authentication", "Role enforcement", "FastAPI dependencies"], "state": 2, "file_id": 11, "knowledge_revision": 52, "git_revision": "6dea69da98dddace0a48b7a3bdd654c526418a60", "revision_history": [{"28": ""}, {"52": "6dea69da98dddace0a48b7a3bdd654c526418a60"}], "ctags": [{"_type": "tag", "name": "_b64decode", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def _b64decode(data: str) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "function", "signature": "(data: str)"}, {"_type": "tag", "name": "_b64encode", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def _b64encode(data: bytes) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: bytes)"}, {"_type": "tag", "name": "_inner", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^    def _inner(token: Optional[str] = None) -> UserPublic:$/", "file": true, "language": "Python", "typeref": "typename:UserPublic", "kind": "function", "signature": "(token: Optional[str] = None)", "scope": "require_role", "scopeKind": "function"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def create_access_token(sub: str, expires_minutes: Optional[int] = None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(sub: str, expires_minutes: Optional[int] = None)"}, {"_type": "tag", "name": "decode_access_token", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def decode_access_token(token: str) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "get_current_user_from_token", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def get_current_user_from_token(token: Optional[str]) -> Optional[UserPublic]:$/", "language": "Python", "typeref": "typename:Optional[UserPublic]", "kind": "function", "signature": "(token: Optional[str])"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "require_auth", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def require_auth(token: Optional[str] = None) -> UserPublic:$/", "language": "Python", "typeref": "typename:UserPublic", "kind": "function", "signature": "(token: Optional[str] = None)"}, {"_type": "tag", "name": "require_role", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def require_role(required: UserRole) -> Callable[..., UserPublic]:$/", "language": "Python", "typeref": "typename:Callable[...,UserPublic]", "kind": "function", "signature": "(required: UserRole)"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/carpool-management-system-161732-161742/carpool_backend/src/core/security.py", "pattern": "/^def verify_password(password: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(password: str, hashed: str)"}], "hash": "a0982d3c996551a649ad5f1d7d797161", "format-version": 4, "code-base-name": "carpool_backend", "filename": "carpool_backend/src/core/security.py"}